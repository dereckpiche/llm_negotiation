# To quickly check if code still runs

defaults:
    - ipd.yaml

experiment:
    name: "debug_${now:%Y-%m-%d___%H-%M-%S}"
    nb_epochs: 1000
    nb_matches_per_iteration: 8
    reinit_matches_each_it: true
    checkpoint_every_n_iterations: 1e5
    start_epoch: 0
    resume_experiment: true
    base_seed: 1000
    train: true

agent_0_id: Alice
agent_1_id: Bob
agent_ids: ["Alice", "Bob"]

markov_games:
    simulation_init_args:
        rounds_per_game: 4


temperature: 1.0

models:
    base_llm:
        class: LeanLocalLLM
        init_args:
            llm_id: base_llm
            model_name: "Qwen/Qwen3-4B-Instruct-2507" # Qwen/Qwen3-4B-Instruct-2507
            inference_backend: vllm
optimizers:
    critic_optimizer:
        module_pointer: agent_critic
        optimizer_class_name: torch.optim.Adam
        init_args:
            lr: 1e-4
            weight_decay: 0.0
trainers:
    agent_trainer:
        kwargs:
            use_gae: True
            gae_lambda_annealing_limit: 0.92
            gae_annealing_temp: 15
            entropy_coeff: 0.0
            kl_coeff: 0.0
            gradient_clipping: 1.0
            restrict_tokens: null
            mini_batch_size: 4
            use_gradient_checkpointing: True
            temperature: ${temperature}
            device: "cuda:0"